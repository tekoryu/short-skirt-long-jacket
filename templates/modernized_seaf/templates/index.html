<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEAG Digital</title>
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="{% static 'css/main.css' %}" rel="stylesheet">
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body x-data="{ darkMode: false }" :class="{ 'dark-mode': darkMode }">
    <!-- Top Navigation Bar -->
    <div class="top-bar" x-data="{ userMenuOpen: false }">
        <div class="top-bar-left">
            <h1 class="project-title">
                <i class="fas fa-rocket"></i>
                SEAG Digital
            </h1>
        </div>
        
        <div class="top-bar-right">
            <!-- Dark Mode Toggle -->
            <button 
                @click="darkMode = !darkMode" 
                class="theme-toggle"
                :aria-label="darkMode ? 'Switch to light mode' : 'Switch to dark mode'"
            >
                <i class="fas" :class="darkMode ? 'fa-sun' : 'fa-moon'"></i>
            </button>
            
            <!-- User Menu -->
            <div class="user-menu" @click.away="userMenuOpen = false">
                <button 
                    class="user-menu-toggle" 
                    @click="userMenuOpen = !userMenuOpen"
                    :aria-expanded="userMenuOpen"
                >
                    <i class="fas fa-user-circle"></i>
                    <span class="user-name">User</span>
                    <i class="fas fa-chevron-down transition-transform" :class="{ 'rotate-180': userMenuOpen }"></i>
                </button>
                
                <div 
                    class="user-menu-dropdown" 
                    x-show="userMenuOpen"
                    x-transition:enter="transition ease-out duration-200"
                    x-transition:enter-start="opacity-0 transform scale-95"
                    x-transition:enter-end="opacity-100 transform scale-100"
                    x-transition:leave="transition ease-in duration-150"
                    x-transition:leave-start="opacity-100 transform scale-100"
                    x-transition:leave-end="opacity-0 transform scale-95"
                    @click="userMenuOpen = false"
                >
                    <a href="/settings/" class="user-menu-item">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                    <a href="/admin/" class="user-menu-item">
                        <i class="fas fa-tools"></i>
                        <span>Admin</span>
                    </a>
                    <a href="/profile/" class="user-menu-item">
                        <i class="fas fa-user"></i>
                        <span>Profile</span>
                    </a>
                    <div class="menu-divider"></div>
                    <a href="/logout/" class="user-menu-item text-danger">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Welcome Section with Alpine.js animations -->
        <div 
            class="welcome-section"
            x-data="{ show: false }"
            x-init="setTimeout(() => show = true, 100)"
            x-show="show"
            x-transition:enter="transition ease-out duration-500"
            x-transition:enter-start="opacity-0 transform translate-y-4"
            x-transition:enter-end="opacity-100 transform translate-y-0"
        >
            <div class="welcome-icon">
                <i class="fas fa-rocket fa-3x"></i>
            </div>
            <h2>Welcome to SEAG Digital</h2>
            <p>Your project dashboard is ready to go!</p>
        </div>

        <!-- Stats Cards with HTMX -->
        <div 
            class="stats-grid"
            hx-get="/api/stats/"
            hx-trigger="load, every 30s"
            hx-swap="innerHTML"
        >
            <!-- Loading state -->
            <div class="stats-card" x-data="{ count: 0 }" x-init="setInterval(() => count = Math.min(count + 1, 42), 50)">
                <div class="stats-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stats-content">
                    <h3 x-text="count">0</h3>
                    <p>Active Users</p>
                </div>
            </div>
            
            <div class="stats-card" x-data="{ count: 0 }" x-init="setInterval(() => count = Math.min(count + 3, 128), 30)">
                <div class="stats-icon">
                    <i class="fas fa-tasks"></i>
                </div>
                <div class="stats-content">
                    <h3 x-text="count">0</h3>
                    <p>Tasks Completed</p>
                </div>
            </div>
            
            <div class="stats-card" x-data="{ count: 0 }" x-init="setInterval(() => count = Math.min(count + 1, 15), 80)">
                <div class="stats-icon">
                    <i class="fas fa-project-diagram"></i>
                </div>
                <div class="stats-content">
                    <h3 x-text="count">0</h3>
                    <p>Active Projects</p>
                </div>
            </div>
            
            <div class="stats-card" x-data="{ count: 0 }" x-init="setInterval(() => count = Math.min(count + 2, 98), 20)">
                <div class="stats-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="stats-content">
                    <h3 x-text="count + '%'">0%</h3>
                    <p>Completion Rate</p>
                </div>
            </div>
        </div>

        <!-- Quick Actions with Alpine.js -->
        <div class="quick-actions-section">
            <h3>Quick Actions</h3>
            <div class="quick-actions-grid" x-data="{ hoveredCard: null }">
                <button 
                    class="action-card"
                    @mouseenter="hoveredCard = 'new-project'"
                    @mouseleave="hoveredCard = null"
                    :class="{ 'hovered': hoveredCard === 'new-project' }"
                    hx-get="/projects/new/"
                    hx-target="#modal-container"
                    hx-swap="innerHTML"
                >
                    <i class="fas fa-plus-circle"></i>
                    <span>New Project</span>
                </button>
                
                <button 
                    class="action-card"
                    @mouseenter="hoveredCard = 'add-task'"
                    @mouseleave="hoveredCard = null"
                    :class="{ 'hovered': hoveredCard === 'add-task' }"
                    hx-get="/tasks/new/"
                    hx-target="#modal-container"
                    hx-swap="innerHTML"
                >
                    <i class="fas fa-clipboard-list"></i>
                    <span>Add Task</span>
                </button>
                
                <button 
                    class="action-card"
                    @mouseenter="hoveredCard = 'invite'"
                    @mouseleave="hoveredCard = null"
                    :class="{ 'hovered': hoveredCard === 'invite' }"
                    hx-get="/team/invite/"
                    hx-target="#modal-container"
                    hx-swap="innerHTML"
                >
                    <i class="fas fa-user-plus"></i>
                    <span>Invite Team</span>
                </button>
                
                <button 
                    class="action-card"
                    @mouseenter="hoveredCard = 'reports'"
                    @mouseleave="hoveredCard = null"
                    :class="{ 'hovered': hoveredCard === 'reports' }"
                    hx-get="/reports/"
                    hx-target="#modal-container"
                    hx-swap="innerHTML"
                >
                    <i class="fas fa-file-alt"></i>
                    <span>View Reports</span>
                </button>
            </div>
        </div>

        <!-- Recent Activity with HTMX infinite scroll -->
        <div class="activity-section">
            <h3>Recent Activity</h3>
            <div 
                class="activity-list"
                hx-get="/api/activity/"
                hx-trigger="load"
                hx-swap="innerHTML"
            >
                <!-- Loading skeleton -->
                <div class="activity-item skeleton">
                    <div class="activity-icon skeleton-circle"></div>
                    <div class="activity-content">
                        <div class="skeleton-line"></div>
                        <div class="skeleton-line short"></div>
                    </div>
                </div>
                <div class="activity-item skeleton">
                    <div class="activity-icon skeleton-circle"></div>
                    <div class="activity-content">
                        <div class="skeleton-line"></div>
                        <div class="skeleton-line short"></div>
                    </div>
                </div>
                <div class="activity-item skeleton">
                    <div class="activity-icon skeleton-circle"></div>
                    <div class="activity-content">
                        <div class="skeleton-line"></div>
                        <div class="skeleton-line short"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal Container for HTMX -->
    <div id="modal-container"></div>

    <!-- Toast Notifications with Alpine.js -->
    <div 
        x-data="{ 
            notifications: [],
            addNotification(message, type = 'info') {
                const id = Date.now();
                this.notifications.push({ id, message, type });
                setTimeout(() => {
                    this.notifications = this.notifications.filter(n => n.id !== id);
                }, 5000);
            }
        }"
        @notify.window="addNotification($event.detail.message, $event.detail.type)"
        class="toast-container"
    >
        <template x-for="notification in notifications" :key="notification.id">
            <div 
                class="toast"
                :class="`toast-${notification.type}`"
                x-show="true"
                x-transition:enter="transition ease-out duration-300"
                x-transition:enter-start="opacity-0 transform translate-x-full"
                x-transition:enter-end="opacity-100 transform translate-x-0"
                x-transition:leave="transition ease-in duration-200"
                x-transition:leave-start="opacity-100 transform translate-x-0"
                x-transition:leave-end="opacity-0 transform translate-x-full"
            >
                <i class="fas" :class="{
                    'fa-check-circle': notification.type === 'success',
                    'fa-info-circle': notification.type === 'info',
                    'fa-exclamation-triangle': notification.type === 'warning',
                    'fa-times-circle': notification.type === 'error'
                }"></i>
                <span x-text="notification.message"></span>
            </div>
        </template>
    </div>
</body>
</html>
